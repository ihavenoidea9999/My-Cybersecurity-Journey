# 【防禦實作】使用 UFW 強化 Linux 網路存取控制 (ACL)  

在網路安全的世界中，「最小權限原則」是防禦的核心。  
Linux 內建的 **UFW (Uncomplicated Firewall)** 提供了一個簡單直覺的介面，  
讓我們能快速實踐網路存取控制（Access Control Lists, ACL），  
保護伺服器免受未授權的連線攻擊。

## 為什麼選擇 UFW？

雖然 Linux 底層使用的是強大的 `iptables`，但其語法對新手來說較為複雜。  
UFW 簡化了設定流程，讓我們能專注於**策略制定**而非語法糾結，  
是練習白名單政策的最佳起點。

---

## 核心防禦概念：預設拒絕 (Default Deny)

在資安實務中，我們通常採用**「白名單政策」**：

1. **Default Deny Incoming**：拒絕所有外部主動建立的連線。除非明確允許，否則誰都進不來。
2. **Default Allow Outgoing**：允許主機主動連往外部（如更新套件、下載資料）。

這種配置能有效減少攻擊面（Attack Surface），即便駭客掃描到你的 IP，若沒有對應的埠號開放，他們也無從下手。

---

## 實作步驟：五分鐘強化系統防線

請打開終端機，依序執行以下指令：

### 1. 檢查目前狀態

在開始設定前，確認防火牆的現況。

```bash
sudo ufw status
# 預設狀態通常為 inactive（未啟用）

```

### 2. 設定基礎原則 (Global Policy)

先定調「進不來、出得去」的基礎邏輯。

```bash
# 拒絕所有外來連線
sudo ufw default deny incoming

# 允許所有對外連線
sudo ufw default allow outgoing

```

### 3. 開放必要埠號 (Critical Ports)

**注意：** 在啟動防火牆前，務必先開啟 SSH 埠號，否則你可能會把自己鎖在伺服器外！

```bash
# 允許 SSH 遠端連線 (Port 22)
sudo ufw allow 22/tcp

# (選填) 如果你有架設網頁伺服器，可開放 80 或 443
# sudo ufw allow 80/tcp

```

### 4. 啟動防火牆

確認規則設定完成後，正式啟用。

```bash
sudo ufw enable

```

*系統會詢問是否可能中斷 SSH 連線，若你已執行步驟 3，請放心按下 `y`。*

---

## 驗證與紀錄

作為一名資安實踐者，測試與驗證與設定同樣重要。

### 驗證指令

使用 `verbose` 參數來查看詳細的規則套用情形：

```bash
sudo ufw status verbose

```

### 預期結果截圖參考

在 GitHub 紀錄中，建議貼上類似下方的結果，證明你的白名單已生效：

> **Status: active**
> **Logging: on (low)**
> **Default: deny (incoming), allow (outgoing), disabled (routed)**
> | To | Action | From |
> | --- | --- | --- |
> | 22/tcp | ALLOW IN | Anywhere |
> | 22/tcp (v6) | ALLOW IN | Anywhere (v6) |
> 
> 

---

## 結語

UFW 的實作僅是網路安全的第一步。  
透過**「預設拒絕」**的邏輯，我們建立了一個穩固的防禦基準。  
下一步，你可以嘗試針對特定 IP 來源進行限制，  
或是整合 `Fail2Ban` 來自動封鎖惡意嘗試登入的行為。
